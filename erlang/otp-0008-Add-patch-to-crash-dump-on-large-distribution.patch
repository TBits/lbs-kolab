From: John Eckersberg <jeckersb@redhat.com>
Date: Wed, 16 Dec 2015 11:03:42 -0500
Subject: [PATCH] Add patch to crash dump on large distribution

https://bugzilla.redhat.com/show_bug.cgi?id=1291822
https://bugzilla.redhat.com/show_bug.cgi?id=1291855
https://bugzilla.redhat.com/show_bug.cgi?id=1291856
https://bugzilla.redhat.com/show_bug.cgi?id=1291857

diff -ur otp-OTP-18.3.3.orig/erts/emulator/beam/dist.c otp-OTP-18.3.3/erts/emulator/beam/dist.c
--- otp-OTP-18.3.3.orig/erts/emulator/beam/dist.c	2016-05-03 10:11:12.000000000 +0200
+++ otp-OTP-18.3.3/erts/emulator/beam/dist.c	2016-05-29 12:35:03.801225329 +0200
@@ -1980,7 +1980,7 @@
     ERTS_SMP_LC_ASSERT(erts_lc_is_port_locked(prt));
 
     if (size > (Uint) INT_MAX)
-	erts_exit(ERTS_ABORT_EXIT,
+	erts_exit(ERTS_DUMP_EXIT,
 		 "Absurdly large distribution output data buffer "
 		 "(%beu bytes) passed.\n",
 		 size);
@@ -2020,7 +2020,7 @@
     ERTS_SMP_LC_ASSERT(erts_lc_is_port_locked(prt));
 
     if (size > (Uint) INT_MAX)
-	erts_exit(ERTS_ABORT_EXIT,
+	erts_exit(ERTS_DUMP_EXIT,
 		 "Absurdly large distribution output data buffer "
 		 "(%beu bytes) passed.\n",
 		 size);
