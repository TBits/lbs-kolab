diff -up ./bin/composer.rpm ./bin/composer
--- ./bin/composer.rpm	2018-05-04 12:59:13.065292434 +0200
+++ ./bin/composer	2018-05-04 13:00:23.293493373 +0200
@@ -6,7 +6,7 @@ if (PHP_SAPI !== 'cli') {
 }
 
 setlocale(LC_ALL, 'C');
-require __DIR__.'/../src/bootstrap.php';
+require '/usr/share/php/Composer/autoload.php';
 
 use Composer\Factory;
 use Composer\XdebugHandler;
diff -up ./src/Composer/Autoload/AutoloadGenerator.php.rpm ./src/Composer/Autoload/AutoloadGenerator.php
--- ./src/Composer/Autoload/AutoloadGenerator.php.rpm	2018-05-04 12:57:41.000000000 +0200
+++ ./src/Composer/Autoload/AutoloadGenerator.php	2018-05-04 12:59:13.066292451 +0200
@@ -305,7 +305,7 @@ EOF;
         file_put_contents($targetDir.'/autoload_real.php', $this->getAutoloadRealFile(true, (bool) $includePathFileContents, $targetDirLoader, (bool) $includeFilesFileContents, $vendorPathCode, $appBaseDirCode, $suffix, $useGlobalIncludePath, $prependAutoloader, $staticPhpVersion));
 
         $this->safeCopy(__DIR__.'/ClassLoader.php', $targetDir.'/ClassLoader.php');
-        $this->safeCopy(__DIR__.'/../../../LICENSE', $targetDir.'/LICENSE');
+        $this->safeCopy((getenv('BUILDROOT')?:'') . '/usr/share/composer/LICENSE', $targetDir.'/LICENSE');
 
         if ($this->runScripts) {
             $this->eventDispatcher->dispatchScript(ScriptEvents::POST_AUTOLOAD_DUMP, $this->devMode, array(), array(
diff -up ./src/Composer/Compiler.php.rpm ./src/Composer/Compiler.php
--- ./src/Composer/Compiler.php.rpm	2018-05-04 12:57:41.000000000 +0200
+++ ./src/Composer/Compiler.php	2018-05-04 12:59:13.066292451 +0200
@@ -97,7 +97,7 @@ class Compiler
         $finder = new Finder();
         $finder->files()
             ->name('*.json')
-            ->in(__DIR__.'/../../res')
+            ->in((getenv('BUILDROOT')?:'') . '/usr/share/composer/res')
             ->in(SpdxLicenses::getResourcesDir())
             ->sort($finderSort)
         ;
diff -up ./src/Composer/Json/JsonFile.php.rpm ./src/Composer/Json/JsonFile.php
--- ./src/Composer/Json/JsonFile.php.rpm	2018-05-04 12:57:41.000000000 +0200
+++ ./src/Composer/Json/JsonFile.php	2018-05-04 12:59:13.066292451 +0200
@@ -156,7 +156,7 @@ class JsonFile
             self::validateSyntax($content, $this->path);
         }
 
-        $schemaFile = __DIR__ . '/../../../res/composer-schema.json';
+        $schemaFile = (getenv('BUILDROOT')?:'') . '/usr/share/composer/res/composer-schema.json';
 
         // Prepend with file:// only when not using a special schema already (e.g. in the phar)
         if (false === strpos($schemaFile, '://')) {
diff -up ./tests/Composer/Test/Json/ComposerSchemaTest.php.rpm ./tests/Composer/Test/Json/ComposerSchemaTest.php
--- ./tests/Composer/Test/Json/ComposerSchemaTest.php.rpm	2018-05-04 12:57:41.000000000 +0200
+++ ./tests/Composer/Test/Json/ComposerSchemaTest.php	2018-05-04 12:59:13.066292451 +0200
@@ -97,7 +97,8 @@ class ComposerSchemaTest extends TestCas
     private function check($json)
     {
         $validator = new Validator();
-        $validator->check(json_decode($json), (object) array('$ref' => 'file://' . __DIR__ . '/../../../../res/composer-schema.json'));
+        $f = (getenv('BUILDROOT')?:'') . '/usr/share/composer/res/composer-schema.json';
+        $validator->check(json_decode($json), (object) array('$ref' => 'file://' . $f));
 
         if (!$validator->isValid()) {
             $errors = $validator->getErrors();
